(function(){AMA.namespace("view.plugin");AMA.view.plugin.ModalGallery={__name__:"ModalGallery",_config:{settings:{container:"#blueimp-gallery",slidesContainer:"div",titleElement:"h3",displayClass:"blueimp-gallery-display",controlsClass:"blueimp-gallery-controls",singleClass:"blueimp-gallery-single",leftEdgeClass:"blueimp-gallery-left",rightEdgeClass:"blueimp-gallery-right",playingClass:"blueimp-gallery-playing",slideClass:"slide",slideLoadingClass:"slide-loading",slideErrorClass:"slide-error",slideContentClass:"slide-content",toggleClass:"toggle",prevClass:"prev",nextClass:"next",closeClass:"close",playPauseClass:"play-pause",typeProperty:"type",titleProperty:"title",urlProperty:"href",displayTransition:true,clearSlides:true,stretchImages:false,toggleControlsOnReturn:true,toggleSlideshowOnSpace:true,enableKeyboardNavigation:true,closeOnEscape:true,closeOnSlideClick:true,closeOnSwipeUpOrDown:true,emulateTouchEvents:true,stopTouchEventsPropagation:false,hidePageScrollbars:true,disableScroll:true,carousel:false,continuous:true,unloadElements:true,startSlideshow:false,slideshowInterval:5000,index:0,preloadRange:2,useBootstrapModal:false,transitionSpeed:400,slideshowTransitionSpeed:undefined,},galleryTemplateId:"#blueimp-gallery_template",detailsObj:""},gallery:false,__onPlug__:function(a){AMA.assert(this.getChild!=null,"ModalGallery plug-in is attached to a non-view host object");this.currentIndex=0;this._config.settings=_.defaults(a.settings,this._config.settings);this._config.galleryTemplateId=_.defaults(a.galleryTemplateId,this._config.galleryTemplateId);this._config.detailsObj=_.defaults(a.detailsObj,this._config.detailsObj);this.initGallery()},initGallery:function(){var a=this;Gallery=blueimp.Gallery;Gallery.prototype.options=this._config.settings;if(!$(this._config.galleryTemplateId).size()){return}this.parent.$el.append($(this._config.galleryTemplateId).html());if(this._config.detailsObj.isRendered){return}this.$el.on("click","[data-gallery]",function(b){var c=$(this).data("gallery");viewObj=a,widget=$(c),container=(widget.length&&widget)||$(Gallery.prototype.options.container),callbacks={onopen:function(){container.data("gallery",this).trigger("open")},onopened:function(){container.trigger("opened")},onslide:function(){viewObj.galleryOnSlide(arguments)},onslideend:function(){container.trigger("slideend",arguments)},onslidecomplete:function(){container.trigger("slidecomplete",arguments)},onclose:function(){container.trigger("close")},onclosed:function(){container.trigger("closed").removeData("gallery")}},options=$.extend(container.data(),{container:container[0],index:this,event:b},callbacks),links=$('[data-gallery="'+c+'"]');if(options.filter){links=links.filter(options.filter)}viewObj.photoGallery=new Gallery(links,options);return viewObj.photoGallery})},galleryOnSlide:function(){var c=arguments[0][0],a=arguments[0][1],e=$(a),d=$(this.selectedItem),f=this,b="#"+$("[data-gallery]")[c].id;this.currentIndex=c;if(e.find("img").attr("src")===d.find("img").attr("src")){$("[data-index="+c+"]").html($(this._config.detailsObj).html())}else{this._selectItem($(b)[0]);this.once(AMA.view.ListView.EVENT.NEW_DATA_LOADED,function(g){this.eventChangesOnGallery(g,c)},this)}},eventChangesOnGallery:function(b,a){$("[data-index="+a+"]").html(b)},galleryOnSlideComplete:function(){},}})();