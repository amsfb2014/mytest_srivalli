/*! DiagnosticScanToolset */
(function(){AMA.namespace("view");var a=AMA.view.DiagnosticScanToolset=AMA.view.BaseView.extend();a.TEMPLATE_ID="diagnostic_scan_toolset_template";a.TEMPLATE_SRC="";a.CSS={CONNECTING:"connecting",UNSUCCESSFUL:"unsuccessful",SUCCESS:"scanned",SCANNING:"scanning",NORMAL:"normal"};_.extend(a.prototype,{events:{"click #button_healthscan_normal, .button_healthscan.unsuccessful":"scan","click .button_healthscan.scanned":"showDiagnosticResults"},initialize:function(){a.__super__.initialize.apply(this,arguments);var b=AMA.ActionManager,c=AMA.workflow.BaseWorkflow,d=AMA.workflow.DiagnosticScanWorkflow;var e=new d();b.define("diagnosticScan",e);e.on(c.EVENT.STATE_CHANGED,function(f){switch(f.state){case c.STATE.INITIALIZING:AMA.debug("Diagnostic Scan Toolset has switched the Scan Button state to 'connecting'; countdown initialized");this.toggleDisplay(a.CSS.CONNECTING);break;case d.STATE.SCANNING:AMA.debug("Diagnostic Scan Toolset has switched the Scan Button state to 'scanning'");this.toggleDisplay(a.CSS.SCANNING);break;default:}},this);e.on(c.EVENT.FINISHED,function(f){switch(f.result){case c.RESULT.SUCCESSFUL:this.toggleDisplay(a.CSS.SUCCESS);if(AMA.config.enableSurveys){AMA.page.openSurvey("health-scan-success")}break;default:this.toggleDisplay(a.CSS.UNSUCCESSFUL);$(".diagnostic_toolset_countdown.countdown_amount").html("05:00");break}},this);e.on(c.EVENT.COUNTDOWN_TICK,function(f){$(".diagnostic_toolset_countdown").html(f.remaining)},this)},toggleDisplay:function(b){this.$el.find("."+b).show().siblings(".button_healthscan").hide()},render:function(){a.__super__.render.apply(this)},scan:function(){AMA.ActionManager.start("diagnosticScan")},showDiagnosticResults:function(){this.toggleDisplay(a.CSS.NORMAL)}})})();